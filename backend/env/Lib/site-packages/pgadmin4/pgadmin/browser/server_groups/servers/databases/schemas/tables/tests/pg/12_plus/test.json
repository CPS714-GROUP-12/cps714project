{
  "scenarios": [
    {
      "type": "create",
      "name": "Create Table without primary key",
      "endpoint": "NODE-table.obj",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql",
      "data": {
        "name": "simple_table_$%{}[]()&*^!@\"'`\\/#",
        "relowner": "postgres",
        "relacl": [],
        "description": "test comment",
        "coll_inherits": "[]",
        "hastoasttable": true,
        "toast_autovacuum_enabled": "x",
        "autovacuum_enabled": "x",
        "primary_key": [],
        "partitions": [],
        "partition_type": "range",
        "is_partitioned": false,
        "schema": "public",
        "columns": [
          {
            "name": "col1",
            "cltype": "integer",
            "attacl": [],
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": null,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col2",
            "cltype": "text",
            "attacl": [],
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": null,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col3",
            "cltype": "boolean",
            "attacl": [],
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": null,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col4",
            "cltype": "character varying",
            "attacl": [],
            "min_val_attlen": 1,
            "max_val_attlen": 2147483647,
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": 30,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col5",
            "cltype": "numeric",
            "attacl": [],
            "min_val_attlen": 1,
            "min_val_attprecision": 0,
            "max_val_attlen": 1000,
            "max_val_attprecision": 1000,
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": 20,
            "attprecision": 10,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col6",
            "cltype": "timestamp with time zone",
            "attacl": [],
            "min_val_attlen": 0,
            "max_val_attlen": 6,
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": 5,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          }
        ],
        "foreign_key": [],
        "check_constraint": [],
        "unique_constraint": [],
        "exclude_constraint": [],
        "partition_keys": [],
        "vacuum_table": [
          {
            "name": "autovacuum_analyze_scale_factor"
          },
          {
            "name": "autovacuum_analyze_threshold"
          },
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "vacuum_toast": [
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "seclabels": [],
        "forcerlspolicy": false,
        "like_default_value": false,
        "like_constraints": false,
        "like_indexes": false,
        "like_storage": false,
        "like_comments": false
      },
      "store_object_id": true,
      "expected_sql_file": "create_table_without_primary_key.sql",
      "expected_msql_file": "create_table_without_primary_key_msql.sql"
    },
    {
      "type": "alter",
      "name": "Alter Table to change column data types",
      "endpoint": "NODE-table.obj_id",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql_id",
      "data": {
        "name": "simple_table_$%{}[]()&*^!@\"'`\\/#",
        "columns": {
          "changed": [
            {
              "attnum": 1,
              "cltype": "bigint"
            },
            {
              "attnum": 2,
              "min_val_attlen": 1,
              "max_val_attlen": 2147483647,
              "cltype": "character varying"
            },
            {
              "attnum": 6,
              "attlen": null,
              "cltype": "time without time zone"
            }
          ]
        }
      },
      "store_object_id": true,
      "expected_sql_file": "alter_table_change_col_data_type.sql",
      "expected_msql_file": "alter_table_change_col_data_type_msql.sql"
    },
    {
      "type": "alter",
      "name": "Alter Table add pk",
      "endpoint": "NODE-table.obj_id",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql_id",
      "data": {
        "name": "simple_table_$%{}[]()&*^!@\"'`\\/#",
        "columns": {
          "changed": [
            {
              "attnum": 1,
              "attnotnull": true,
              "is_primary_key": true
            }
          ]
        },
        "primary_key": {
          "added": [
            {
              "columns": [
                {
                  "column": "col1"
                }
              ],
              "include": []
            }
          ]
        }
      },
      "store_object_id": true,
      "expected_sql_file": "alter_table_add_pk_not_null_constraint.sql",
      "expected_msql_file": "alter_table_add_pk_not_null_constraint_msql.sql"
    },
    {
      "type": "alter",
      "name": "Alter Table add null constraint, rename column",
      "endpoint": "NODE-table.obj_id",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql_id",
      "data": {
        "name": "simple_table_$%{}[]()&*^!@\"'`\\/#",
        "columns": {
          "changed": [
            {
              "attnum": 1,
              "name": "col1_rename",
              "is_primary_key": false
            },
            {
              "attnum": 4,
              "attnotnull": true
            }
          ]
        }
      },
      "store_object_id": true,
      "expected_sql_file": "alter_table_add_null_constraint_rename_col.sql",
      "expected_msql_file": "alter_table_add_null_constraint_rename_col_msql.sql"
    },
    {
      "type": "delete",
      "name": "Delete Table add pk",
      "endpoint": "NODE-table.obj_id",
      "data": {
        "name": "simple_table_$%{}[]()&*^!@\"'`\\/#"
      }
    },
    {
      "type": "create",
      "name": "Create Table with primary key",
      "endpoint": "NODE-table.obj",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql",
      "data": {
        "name": "simple_table_with_pk$%{}[]()&*^!@\"'`\\/#",
        "relowner": "postgres",
        "relacl": [],
        "description": "test comment",
        "coll_inherits": "[]",
        "hastoasttable": true,
        "toast_autovacuum_enabled": "x",
        "autovacuum_enabled": "x",
        "primary_key": [
          {
            "columns": [
              {
                "column": "col1_$%{}[]()&*^!@\\\"'`\\\\/#"
              }
            ],
            "include": []
          }
        ],
        "partitions": [],
        "partition_type": "range",
        "is_partitioned": false,
        "schema": "public",
        "columns": [
          {
            "name": "col1_$%{}[]()&*^!@\\\"'`\\\\/#",
            "cltype": "integer",
            "attacl": [],
            "is_primary_key": true,
            "attnotnull": false,
            "attlen": null,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col2_$%{}[]()&*^!@\\\"'`\\\\/#",
            "cltype": "json",
            "attacl": [],
            "is_primary_key": false,
            "attnotnull": true,
            "attlen": null,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          }
        ],
        "foreign_key": [],
        "check_constraint": [],
        "unique_constraint": [],
        "exclude_constraint": [],
        "partition_keys": [],
        "vacuum_table": [
          {
            "name": "autovacuum_analyze_scale_factor"
          },
          {
            "name": "autovacuum_analyze_threshold"
          },
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "vacuum_toast": [
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "seclabels": [],
        "forcerlspolicy": false,
        "like_default_value": false,
        "like_constraints": false,
        "like_indexes": false,
        "like_storage": false,
        "like_comments": false
      },
      "store_object_id": true,
      "expected_sql_file": "create_table_with_pk.sql",
      "expected_msql_file": "create_table_with_pk_msql.sql"
    },
    {
      "type": "alter",
      "name": "Alter Table add columns",
      "endpoint": "NODE-table.obj_id",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql_id",
      "data": {
        "name": "simple_table_with_pk$%{}[]()&*^!@\"'`\\/#",
        "columns": {
          "added": [
            {
              "name": "col3_$%{}[]()&*^!@\\\"'`\\\\/#",
              "cltype": "numeric",
              "attacl": [],
              "min_val_attlen": 1,
              "min_val_attprecision": 0,
              "max_val_attlen": 1000,
              "max_val_attprecision": 1000,
              "is_primary_key": false,
              "attnotnull": false,
              "attlen": 10,
              "attprecision": 5,
              "attidentity": "a",
              "colconstype": "n",
              "attoptions": [],
              "seclabels": []
            },
            {
              "name": "col4_$%{}[]()&*^!@\\\"'`\\\\/#",
              "cltype": "text",
              "attacl": [],
              "is_primary_key": false,
              "attnotnull": false,
              "attlen": null,
              "attprecision": null,
              "attidentity": "a",
              "colconstype": "n",
              "attoptions": [],
              "seclabels": []
            }
          ]
        }
      },
      "store_object_id": true,
      "expected_sql_file": "alter_table_add_cols.sql",
      "expected_msql_file": "alter_table_add_cols_msql.sql"
    },
    {
      "type": "alter",
      "name": "Alter Table delete columns",
      "endpoint": "NODE-table.obj_id",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql_id",
      "data": {
        "name": "simple_table_with_pk$%{}[]()&*^!@\"'`\\/#",
        "columns": {
          "deleted": [
            {
              "attoptions": [],
              "attacl": [],
              "seclabels": [],
              "name": "col2_$%{}[]()&*^!@\\\"'`\\\\/#",
              "atttypid": 114,
              "attnum": 2,
              "cltype": "json",
              "collspcname": "",
              "description": null,
              "edit_types": [
                "json",
                "jsonb"
              ],
              "is_primary_key": false,
              "attstattarget": -1,
              "attnotnull": true,
              "attlen": null,
              "attprecision": null,
              "attidentity": "a",
              "colconstype": "n",
              "attndims": 0,
              "atttypmod": -1,
              "attstorage": "x",
              "defval": null,
              "typname": "json",
              "displaytypname": "json",
              "elemoid": 114,
              "typnspname": "pg_catalog",
              "defaultstorage": "x",
              "indkey": "1",
              "isdup": false,
              "is_fk": false,
              "is_sys_column": false,
              "relname": "simple_table_with_pk$%{}[]()&*^!@\"'`\\/#",
              "is_view_only": false,
              "is_pk": false,
              "old_attidentity": "a"
            }
          ]
        }
      },
      "store_object_id": true,
      "expected_sql_file": "alter_table_delete_cols.sql",
      "expected_msql_file": "alter_table_delete_cols_msql.sql"
    },
    {
      "type": "delete",
      "name": "Delete Table delete columns",
      "endpoint": "NODE-table.obj_id",
      "data": {
        "name": "simple_table_with_pk$%{}[]()&*^!@\"'`\\/#"
      }
    },
    {
      "type": "create",
      "name": "Create Table with pk & check constraint",
      "endpoint": "NODE-table.obj",
      "sql_endpoint": "NODE-table.sql_id",
      "msql_endpoint": "NODE-table.msql",
      "data": {
        "name": "table_with_pk_chk_constraints$%{}[]()&*^!@\"'`\\/#",
        "relowner": "postgres",
        "relacl": [],
        "description": "create table comment",
        "coll_inherits": "[]",
        "hastoasttable": true,
        "toast_autovacuum_enabled": "x",
        "autovacuum_enabled": "x",
        "primary_key": [
          {
            "name": "custom_pk",
            "comment": "custom pk created",
            "fillfactor": "11",
            "condeferrable": true,
            "condeferred": true,
            "columns": [
              {
                "column": "col1_$%{}[]()&*^!@\\\"'`\\\\/#"
              }
            ],
            "include": []
          }
        ],
        "partitions": [],
        "partition_type": "range",
        "is_partitioned": false,
        "schema": "public",
        "columns": [
          {
            "name": "col1_$%{}[]()&*^!@\\\"'`\\\\/#",
            "cltype": "time with time zone",
            "attacl": [],
            "min_val_attlen": 0,
            "max_val_attlen": 6,
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": 5,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          },
          {
            "name": "col2",
            "cltype": "character",
            "attacl": [],
            "min_val_attlen": 1,
            "max_val_attlen": 2147483647,
            "is_primary_key": false,
            "attnotnull": false,
            "attlen": 12,
            "attprecision": null,
            "attidentity": "a",
            "colconstype": "n",
            "attoptions": [],
            "seclabels": []
          }
        ],
        "foreign_key": [],
        "check_constraint": [
          {
            "name": "chk_const",
            "consrc": "col2  != null",
            "convalidated": false,
            "comment": "chk const comment"
          }
        ],
        "unique_constraint": [],
        "exclude_constraint": [],
        "partition_keys": [],
        "vacuum_table": [
          {
            "name": "autovacuum_analyze_scale_factor"
          },
          {
            "name": "autovacuum_analyze_threshold"
          },
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "vacuum_toast": [
          {
            "name": "autovacuum_freeze_max_age"
          },
          {
            "name": "autovacuum_vacuum_cost_delay"
          },
          {
            "name": "autovacuum_vacuum_cost_limit"
          },
          {
            "name": "autovacuum_vacuum_scale_factor"
          },
          {
            "name": "autovacuum_vacuum_threshold"
          },
          {
            "name": "autovacuum_freeze_min_age"
          },
          {
            "name": "autovacuum_freeze_table_age"
          }
        ],
        "seclabels": [],
        "forcerlspolicy": false,
        "like_default_value": false,
        "like_constraints": false,
        "like_indexes": false,
        "like_storage": false,
        "like_comments": false
      },
      "store_object_id": true,
      "expected_sql_file": "create_table_with_pk_chk.sql",
      "expected_msql_file": "create_table_with_pk_chk_msql.sql"
    }
  ]
}
